<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
</head>
<body>
<h1>Zauber-o-Mat - Das Zauberspruchberechnungstool für ERPS</h1>
[-
####################################
# Die Web-App für den Zauber-o-Mat #
####################################

# use strict;
use utf8;
use Eomconfig;
use Data::Dumper;
# use diagnostics;
use Charakter;
use Spruch;
use Erps;
use POSIX;

$conf = Eomconfig->new();
Erps->init_erps($conf);
$stoffel = Charakter->new($conf->{-DEFAULT_CHARAKTER},$conf);

# Sprueche initialisieren
my $spruch_hash = {};
$spruch_list = [];
Spruch->init_sprueche($spruch_hash,$spruch_list,$stoffel,'web');

# charaktere initialisieren
$char_list = [];
# Charakter->init_chars($char_list,$spruch_hash);
Charakter->init_chars($char_list);

# nur der Defaultspruch...
$sprucho = $spruch_hash->{$conf->{-DEFAULT_SPRUCH}};
-]
<p>
<form method="get" action="Zauber-o-Mat.epl">

Charakter: <select name="charakter">
[$ foreach $char (@$char_list) $]
<option>[+ $char +]</option>
[$ endforeach $]
</select>
<p>


[$ if exists $fdat{charakter} $]
[- $stoffel = Charakter->new($fdat{charakter},$conf); -]

<hr>
<h2>[+ $stoffel->{'Name'} +]</h2>
<p>
PSE: <input type="text" size="2" maxlength="2" name="PSE" value="
[+ $stoffel->{'Fertigkeit'}->{'PSE'} +]">

<p>
PSI: <input type="text" size="2" maxlength="2" name="PSI" value="
[+ $stoffel->{'Basisattribut'}->{'PSI'} +]">

<p>
Magietheorie: <input type="text" size="2" maxlength="2" name="Magietheorie"
value="
[+ $stoffel->{'Fertigkeit'}->{'Magietheorie'} +]">

<hr>
<h2>Allgemeines</h2>
<p>

Spruch: <select name="spruch">
[$ foreach $spruch (@$spruch_list) $]
<option>[+ $spruch +]</option>
[$ endforeach $]
</select>

<p>
Spruchdauer: <select name="dauer">
<option selected>Sofortiger Zauber</option>
<option>Rundenzauber</option>
<option>Minutenzauber</option>
<option>Stundenzauber</option>
<option>Tagezauber</option>
</select>

<p>
MW-Modifikationen: <select name="mw_mod">
<option selected>0</option>
[$ foreach $i (1..20) $]
<option>[+ $i +]</option>
[$ endforeach $]
</select>

<p>
Würfel-Modifikationen: <select name="wuerfel_mod">
[$ foreach $i (-10..-1) $]
<option>[+ $i +]</option>
[$ endforeach $]
<option selected>0</option>
[$ foreach $i (1..10) $]
<option>[+ $i +]</option>
[$ endforeach $]
</select>

<p>
Gesenkt um: <select name="gesenkt_um">
<option selected>0</option>
[$ foreach $i (1..20) $]
<option>[+ $i +]</option>
[$ endforeach $]
</select>

<p>
Nach dem Senken negative PSI-Punkte?
<input type="checkbox" name="ist_negativ" value="0">

<hr>
<h2>Spruchabhängige Parameter</h2>

[-
$sprucho->create_oberflaeche();
-]
[+ $sprucho->get_form() +]


[$ else $]
Kein Charakter ausgewählt.
[$ endif $]


<p>
<input type="submit" name="submit" value="Berechnen">

</form>
<p>


</body></html>

